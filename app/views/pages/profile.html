<div class="container profiles" style="margin-top: 80px;">
    <div class="row">
        <div class="col-md-4">
            <div class="row">
                <div class="col-md-12 user_profile" align="center">
                    <form method="post" id="form">
                        <?php if(!empty($result['account'])): ?>
                            <?php foreach($result['account']as $row => $info): ?>
                                <div class="img-wrapper" align="center">
                                    <?php if(!empty($info->image_name)): ?>
                                        <img id="preview" src="<?=base_url();?>upload/<?=$info->image_name?>" alt="">
                                    <?php else: ?>
                                        <img id="preview" src="<?=base_url();?>upload/avatar.jfif" alt="">
                                    <?php endif; ?>
                                    <input type="file" name="file" id="file">
                                    <input type="hidden" name="id" id="id" value="<?=$info->id?>">
                                </div>
                                <br>
                                <h4 style="font-weight: bold; font-size: 20px;"><?=$info->user_call_sign?></h4>
                                <h4><?=$info->chapter?></h4>
                                <br>
                                <button type="submit" class="btn btn-default file-holder" style="width: 156px;">UPLOAD IMAGE</button>
                                <br>
                                <a href="<?=base_url();?>page/update/information.html/<?= $this->session->userdata('user_id'); ?>/<?= $this->session->userdata('user_call_sign')?>/" class="btn btn-info update">UPDATE PROFILE</a>
                                <br><br><br>
                            <?php endforeach; ?>
                        <?php else: ?>
                                <div class="img-wrapper" align="center">
                                    <img id="preview" src="<?=base_url();?>upload/avatar.jfif" alt="">
                                    <input type="file" name="file" id="file">
                                    <input type="hidden" name="id" id="id" value="<?=$info->id?>">
                                </div>
                                <br>
                                <h4 style="font-weight: bold; font-size: 20px;"></h4>
                                <h4></h4>
                                <br>
                                <button type="submit" class="btn btn-default file-holder" style="width: 156px;">UPLOAD IMAGE</button>
                                <br>
                                <a href="#" class="btn btn-info update">UPDATE PROFILE</a>
                                <br><br><br>
                        <?php endif; ?>
                    </form>
                </div>
                <div class="col-md-12" style="margin-top: 20px; padding-left: 0px; padding-right: 0px;">
                    <h3>USER ACCOUNT</h3>
                    <div class="info" style="overflow: hidden;">
                        <?php if(!empty($result['account'])): ?>
                            <?php foreach($result['account']as $row => $info): ?>
                                <h5>Username: <span><?=$info->username?></span></h5>
                                <h5><a href="<?= base_url(); ?>page/user/change-password.html/<?=$info->username?>">Change Password</a></h5>
                            <?php endforeach; ?>
                        <?php endif; ?>
                    </div>
                </div>
                
            </div>
        </div>
        <div class="col-md-8 personnal_info">
            <div class="row">
                <div class="col-md-12">
                    <h3>PERSONAL INFORMATION</h3>
                    <div class="info">
                        <?php if(!empty($result['personnal_info'])): ?>
                            <?php foreach($result['personnal_info']as $row => $info): ?>
                                <h5>Fullname: <span><?=$info->full_name?></span></h5>
                                <h5>Contact: <span><?=$info->contact?></span></h5>
                                <h5>Present Employment: <span><?=$info->present_employment?></span></h5>
                                <h5>Home Address: <span><?=$info->home_address?></span></h5>
                                <h5>Date of Birth: <span><?=$info->date_of_birth?></span></h5>
                                <h5>Place of Birth: <span><?=$info->place_of_birth?></span></h5>
                                <h5>Citizenship: <span><?=$info->citizenship?></span></h5>
                                <h5>Gender: <span><?=$info->gender?></span></h5>
                                <h5>Height: <span><?=$info->height?></span></h5>
                                <h5>Weight: <span><?=$info->weight?></span></h5>
                                <h5>Blood Type: <span><?=$info->blood_type?></span></h5>
                            <?php endforeach; ?>
                        <?php else: ?>
                            <h5>Fullname: <span></span></h5>
                            <h5>Contact: <span></span></h5>
                            <h5>Present Employment: <span></span></h5>
                            <h5>Home Address: <span></span></h5>
                            <h5>Date of Birth: <span></span></h5>
                            <h5>Place of Birth: <span></span></h5>
                            <h5>Citizenship: <span></span></h5>
                            <h5>Gender: <span></span></h5>
                            <h5>Height: <span></span></h5>
                            <h5>Weight: <span></span></h5>
                            <h5>Blood Type: <span></span></h5>
                        <?php endif; ?>
                    </div>
                </div>
                    
                <div class="col-md-12">
                    <br>
                    <h3>OTHER INFORMATION</h3>
                    <div class="info">
                        <?php if(!empty($result['other_info'])): ?>
                            <?php foreach($result['other_info']as $row => $info): ?>
                                <h5>Emergency Contact Person: <span><?=$info->emergency_contact_person?></span></h5>
                                <h5>Relation: <span><?=$info->relation_to_member?></span></h5>
                                <h5>Emergency Contact No: <span><?=$info->emergency_contact_num?></span></h5>
                                <h5>Father's name: <span><?=$info->name_of_father?></span> </h5>
                                <h5>Occupation: <span><?=$info->fathers_occupation?></span></h5>
                                <h5>Mother's name: <span><?=$info->name_of_mother?></span></h5>
                                <h5>Occupation: <span><?=$info->mothers_occupation?></span></h5>
                            <?php endforeach; ?>
                        <?php else: ?>
                            <h5>Emergency Contact Person: <span></span></h5>
                            <h5>Relation: <span></span></h5>
                            <h5>Emergency Contact No: <span></span></h5>
                            <h5>Father's name: <span></span> </h5>
                            <h5>Occupation: <span></span></h5>
                            <h5>Mother's name: <span></span></h5>
                            <h5>Occupation: <span</span></h5>
                        <?php endif; ?>
                    </div>
                </div>

                <div class="col-md-12">
                    <br>
                    <h3>SET-UP/EQUIPMENT</h3>
                    <div class="info">
                        <?php if(!empty($result['equipment'])): ?>
                            <?php foreach($result['equipment']as $row => $info): ?>
                                <h5>HF Radio: <span><?=$info->hf_radio?></span></h5>
                                <h5>VHF Radio: <span><?=$info->vhf_radio?></span></h5>
                                <h5>UHF Radio: <span><?=$info->uhf_radio?></span></h5>
                                <h5>Aerial Antenna: <span><?=$info->aerial_antenna?></span> </h5>
                                <h5>Spare Battery: <span><?=$info->spare_battery?></span></h5>
                                <h5>Generator: <span><?=$info->generator?></span></h5>
                                <h5>Solar Panel: <span><?=$info->solar_panel?></span></h5>
                                <h5>Battery: <span><?=$info->battery?></span></h5>
                                <h5>Mobile Set-Up: <span><?=$info->mobile_set_up?></span></h5>
                                <h5>Drone: <span><?=$info->drone?></span></h5>
                            <?php endforeach; ?>
                        <?php else: ?>
                            <h5>HF Radio: <span></span></h5>
                            <h5>VHF Radio: <span></span></h5>
                            <h5>UHF Radio: <span></span></h5>
                            <h5>Aerial Antenna: <span></span> </h5>
                            <h5>Spare Battery: <span></span></h5>
                            <h5>Generator: <span></span></h5>
                            <h5>Solar Panel: <span></span></h5>
                            <h5>Battery: <span></span></h5>
                            <h5>Mobile Set-Up: <span></span></h5>
                            <h5>Drone: <span></span></h5>
                        <?php endif; ?>
                    </div>
                </div>

                <div class="col-md-12">
                    <br>
                    <h3>SIBLINGS/CHILDREN</h3>
                    <div class="info">
                        <?php if(!empty($result['children_sibling'])): ?> 
                            <?php for($i = 0; $i < count($result['children_sibling']); $i++): ?>
                                <h5>Name: <span><?=$result['children_sibling'][$i]['siblings_childrens_name']?></span></h5>
                            <?php endfor; ?>
                        <?php else: ?>
                            <h5>Name: <span></span></h5>
                        <?php endif; ?>
                    </div>
                </div>

                <div class="col-md-12">
                    <br>
                    <h3>SCHOOL ATTENDED</h3>
                    <div class="info">
                        <?php if(!empty($result['school_attended'])): ?>  
                            <h5>Secondary: <span><?=(!empty($result['school_attended'][0]['school']) ? $result['school_attended'][0]['school'] : '' )?></span></h5>
                            <h5>Date Graduated: <span><?=(!empty($result['school_attended'][0]['date_graduate']) ? $result['school_attended'][0]['date_graduate'] : '' )?></span></h5>
                            <h5>College: <span><?=(!empty($result['school_attended'][1]['school']) ? $result['school_attended'][0]['school'] : '' )?></span></h5>
                            <h5>Date Graduated: <span><?=(!empty($result['school_attended'][1]['date_graduate']) ? $result['school_attended'][0]['date_graduate'] : '' )?></span></h5>
                            <h5>Post Graduate: <span><?=(!empty($result['school_attended'][2]['school']) ? $result['school_attended'][0]['school'] : '' )?></span></h5>
                            <h5>Date Graduated: <span><?=(!empty($result['school_attended'][2]['date_graduate']) ? $result['school_attended'][0]['date_graduate'] : '' )?></span></h5>
                        <?php else: ?>
                        <h5>Secondary: <span></span></h5>
                            <h5>Date Graduated: <span></span></h5>
                            <h5>College: <span></span></h5>
                            <h5>Date Graduated: <span></span></h5>
                            <h5>Post Graduate: <span></span></h5>
                            <h5>Date Graduated: <span></span></h5>
                        <?php endif; ?>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<br>
<br>
<br>
<script>
    $(document).ready(function(){
        var file = document.getElementById('file');
        $('.img-wrapper').on('click', function(){
            file.click();
        })

        function readURL(input){
			if (input.files && input.files[0]) {
				var reader = new FileReader();
				reader.onload = function(e){
					$('#preview').attr('src', e.target.result);
				}
				reader.readAsDataURL(input.files[0]);
			}
		}
		$(document).on('change', 'input[type="file"]', function(){
			readURL(this);
            // $('.img-wrapper').addClass('has-image');
		})

        $(document).on('submit', '#form', function(e){
            e.preventDefault();
            if($('input[type="file"]').val() != ''){
                $.ajax({
                    url: '<?= base_url(); ?>user/upload_image/' + $('input[name="id"]').val(),
                    type: 'POST',
                    data: new FormData(this),
                    contentType: false,
                    cache: false,
                    processData: false,
                    success:function(data){
                        const log_oObj = JSON.parse(data);
                        console.log(log_oObj);
                        if(log_oObj.upload == true){
                            swal(
                                {
                                    title: 'SUCCESSFUL',
                                    text : log_oObj.message,
                                    type : "success",
                                    showCancelButton  : false,
                                    confirmButtonColor: "#A5DC86",
                                    confirmButtonText : "OK",
                                    cancelButtonText  : "",
                                    closeOnConfirm    : true,
                                    closeOnCancel     : false 
                                }
                            );
                            $('form')[0].reset();
                        }
                        else{
                            swal(
                                {
                                    title: "ERROR",
                                    text : log_oObj.message,
                                    type : "error",
                                    showCancelButton  : false,
                                    confirmButtonColor: "#F27474",
                                    confirmButtonText : "OK",
                                    cancelButtonText  : "",
                                    closeOnConfirm    : true,
                                    closeOnCancel     : false 
                                }
                            );
                        } 
                    }
                });
            }
            else{
                swal(
                    {
                        title: "WARNING",
                        text : 'Please select image before uploading.',
                        type : "warning",
                        showCancelButton  : false,
                        confirmButtonColor: "#F8C886",
                        confirmButtonText : "OK",
                        cancelButtonText  : "",
                        closeOnConfirm    : true,
                        closeOnCancel     : false 
                    }
                );
            }
        })
    })
</script>